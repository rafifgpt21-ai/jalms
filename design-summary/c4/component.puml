@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Component Diagram for JALMS (Web Application)

Container(webapp, "Web App Client", "React, Next.js Client Components", "The client-side UI components.")

ContainerDb(db, "Database", "MongoDB", "Stores all data.")
Container(storage, "Local File System", "Disk", "Stores files locally.")

Container_Boundary(api, "Next.js Server Side (Server Actions / API)") {
    Component(auth, "Auth Component", "NextAuth.js", "Handles authentication, sessions, and authorization (Roles).")
    
    Component(userComp, "User Management", "Service/Action", "CRUD for Users, Profiles, Avatars.")
    Component(acadComp, "Academic Management", "Service/Action", "Manage Years, Semesters (Terms), Classes, Subjects.")
    Component(courseComp, "Course Management", "Service/Action", "Manage Courses, Enrollments, Schedules.")
    Component(matComp, "Material Component", "Service/Action", "Manage learning materials and file uploads.")
    Component(assignComp, "Assignment & Grade Component", "Service/Action", "Manage Assignments, Submissions, Quizzes, Grading.")
    Component(attComp, "Attendance Component", "Service/Action", "Track student attendance.")
    Component(commComp, "Communication Component", "Service/Action", "Chat, Messages, Conversations.")
    
    Component(prisma, "Data Access Layer", "Prisma Client", "Type-safe database interaction.")
}

Rel(webapp, auth, "Authenticates via")
Rel(webapp, userComp, "Manages Profile")
Rel(webapp, acadComp, "Views/Manages Academic Info")
Rel(webapp, courseComp, "Views/Manages Courses")
Rel(webapp, matComp, "Views/Uploads Materials")
Rel(webapp, assignComp, "Submits/Grades Assignments")
Rel(webapp, attComp, "Records/Views Attendance")
Rel(webapp, commComp, "Sends Messages")

Rel(auth, prisma, "Reads User/Role")
Rel(userComp, prisma, "CRUD User")
Rel(acadComp, prisma, "CRUD Academic Entities")
Rel(courseComp, prisma, "CRUD Courses/Enrollments")
Rel(matComp, prisma, "CRUD Materials")
Rel(assignComp, prisma, "CRUD Assignments/Grades")
Rel(attComp, prisma, "CRUD Attendance")
Rel(commComp, prisma, "CRUD Messages")

Rel(prisma, db, "Reads/Writes")

Rel(userComp, storage, "Uploads Avatars")
Rel(matComp, storage, "Uploads Material Files")
Rel(assignComp, storage, "Uploads Submission Attachments")

@enduml
